{"version":3,"sources":["screens/Admin.js"],"names":["BaseContainer","styled","div","AdminForm","StyledTextField","TextField","StyledNumberField","StyledRadio","Radio","FooterDiv","MiddleDiv","StyledButton","Button","StyledSnackBar","Snackbar","StyledRadioGroup","RadioGroup","daysOfTheWeek","convertTo12Hour","time","moment","Date","format","split","convertHourToIsoDate","amPm","currentMilitaryTime","convertToMilitary","momentDate","momentDateTime","toDate","toISOString","withRouter","props","useState","companyName","occupancyRule","currentRules","successMessage","reservationClearOut","formData","setFormData","reservationsExpired","reservationsCheckedIn","day","reservationMetrics","setReservationMetrics","radioValue","setRadioValue","isTimeError","setTimeError","checkInData","JSON","parse","localStorage","getItem","STORAGE","CHECK_IN_HISTORY","slice","reverse","open","setOpen","attendanceData","map","item","positiveCount","negativeCount","savedSuccessfully","setSavedSuccessfully","lineChartInfo","labels","getDay","getMonth","getDate","datasets","label","fill","lineTension","backgroundColor","borderColor","borderWidth","data","useEffect","getSettings","then","res","json","response","catch","e","console","log","getAllReservations","reservationHistory","handleTextFieldChange","target","getAttribute","value","InputLabelProps","shrink","fullWidth","type","placeholder","name","onChange","onBlur","handleTimeBlur","error","helperText","InputProps","inputProps","min","max","row","handleRadioChange","control","options","title","display","text","fontSize","legend","position","autoHideDuration","anchorOrigin","vertical","horizontal","onClose","event","reason","severity","size","variant","onClick","setSettings"],"mappings":"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","file":"static/js/4.420260e0.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport {\n  TextField,\n  Button,\n  Snackbar,\n  Radio,\n  FormControlLabel,\n  RadioGroup,\n} from '@material-ui/core';\nimport moment from 'moment';\nimport MuiAlert from '@material-ui/lab/Alert';\nimport styled from 'styled-components';\nimport { withRouter } from 'react-router-dom';\nimport {\n  getSettings,\n  setSettings,\n  getAllReservations,\n} from '../services/apiCalls';\nimport { Line } from 'react-chartjs-2';\nimport { STORAGE } from '../common/constants';\n\nconst BaseContainer = styled.div`\n  display: flex;\n  flex: 1 0;\n  flex-direction: column;\n  justify-content: space-between;\n`;\n\nconst AdminForm = styled.div`\n  margin: 3rem 2rem 0rem 2rem;\n`;\n\nconst StyledTextField = styled(TextField)`\n  margin-bottom: 1rem !important;\n`;\n\nconst StyledNumberField = styled(TextField)`\n  width: 45% !important;\n  margin-right: 1rem !important;\n`;\n\nconst StyledRadio = styled(Radio)`\n  color: #1380e2 !important;\n`;\n\nconst FooterDiv = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  align-items: flex-start;\n`;\n\nconst MiddleDiv = styled.div`\n  display: flex;\n  justify-content: center;\n\n  canvas {\n    max-height: 40rem !important;\n    max-width: 40rem !important;\n  }\n`;\n\nconst StyledButton = styled(Button)`\n  align-self: flex-end;\n  margin: 0rem 2rem 1rem 1rem !important;\n  width: 8rem;\n  background-color: #288bea !important;\n  color: #ffffff !important;\n`;\n\nconst StyledSnackBar = styled(Snackbar)`\n  position: inherit !important;\n  margin-right: auto;\n  margin-left: 2rem;\n`;\n\nconst StyledRadioGroup = styled(RadioGroup)`\n  display: inline !important;\n`;\n\nconst daysOfTheWeek = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n\n// this assumes a full datetime string\nconst convertTo12Hour = (time) => {\n  return moment(new Date(time), 'HH:mm').format('h a').split(' ');\n};\n\n// this assumes a string such as \"1 am\"\nconst convertToMilitary = (time, amPm) => {\n  return moment(`${time} ${amPm}`, 'h a').format('HH:mm');\n};\n\nconst convertHourToIsoDate = (time, amPm) => {\n  const currentMilitaryTime = convertToMilitary(time, amPm);\n  const momentDate = moment(new Date()).format('L');\n  const momentDateTime = moment(\n    `${momentDate} ${currentMilitaryTime}`,\n    'MM/DD/YYYY HH:mm'\n  ).format();\n  return moment(momentDateTime).toDate().toISOString();\n};\n\nconst Admin = (props) => {\n  const [formData, setFormData] = useState({\n    companyName: '',\n    occupancyRule: '',\n    currentRules: '',\n    successMessage: '',\n    reservationClearOut: '12',\n  });\n  const [reservationMetrics, setReservationMetrics] = useState([\n    {\n      reservationsExpired: 0,\n      reservationsCheckedIn: 0,\n      day: '2020-06-12',\n    },\n  ]);\n  const [radioValue, setRadioValue] = useState('am');\n  const [isTimeError, setTimeError] = useState(false);\n\n  const checkInData = JSON.parse(localStorage.getItem(STORAGE.CHECK_IN_HISTORY))\n    .slice(0, 7)\n    .reverse();\n\n  const [open, setOpen] = useState(false);\n  const attendanceData = checkInData.map(\n    (item) => item.positiveCount + item.negativeCount\n  );\n\n  const [savedSuccessfully, setSavedSuccessfully] = useState(true);\n  const xAxis = checkInData.map(\n    (item) =>\n      `${daysOfTheWeek[new Date(item.Date).getDay()]} ${new Date(\n        item.Date\n      ).getMonth()}/${new Date(item.Date).getDate()}`\n  );\n  const lineChartInfo = {\n    labels: xAxis,\n    datasets: [\n      {\n        label: 'Regular Check ins',\n        fill: false,\n        lineTension: 0.5,\n        backgroundColor: '#288bea',\n        borderColor: '#288bea',\n        borderWidth: 3,\n        data: attendanceData,\n      },\n      {\n        label: 'Fulfilled Reservations',\n        fill: false,\n        lineTension: 0.5,\n        backgroundColor: '#53928b',\n        borderColor: '#53928b',\n        borderWidth: 3,\n        data: reservationMetrics.map((item) => item.reservationsCheckedIn),\n      },\n      {\n        label: 'Expired Reservations',\n        fill: false,\n        lineTension: 0.5,\n        backgroundColor: '#bb251a',\n        borderColor: '#bb251a',\n        borderWidth: 3,\n        data: reservationMetrics.map((item) => item.reservationsExpired),\n      },\n    ],\n  };\n\n  const lineChartOptions = {\n    title: {\n      display: true,\n      text: 'Metrics for Past Seven Days',\n      fontSize: 20,\n    },\n    legend: {\n      display: true,\n      position: 'right',\n    },\n  };\n\n  useEffect(() => {\n    getSettings()\n      .then((res) => res.json())\n      .then((response) => {\n        setFormData({\n          ...response,\n          reservationClearOut: convertTo12Hour(response.reservationClearOut)[0],\n        });\n        setRadioValue(convertTo12Hour(response.reservationClearOut)[1]);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n\n    getAllReservations()\n      .then((res) => res.json())\n      .then((response) => {\n        setReservationMetrics(response.reservationHistory.reverse());\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  }, []);\n\n  const handleTextFieldChange = (e) => {\n    setFormData({\n      ...formData,\n      [e.target.getAttribute('name')]: e.target.value,\n    });\n  };\n\n  const handleRadioChange = (e) => {\n    setRadioValue(e.target.value);\n  };\n\n  const handleTimeBlur = (e) => {\n    setTimeError(e.target.value <= 1 || e.target.value >= 12);\n  };\n\n  const handleClick = () => {\n    setSettings({\n      ...formData,\n      reservationClearOut: new Date(\n        convertHourToIsoDate(formData.reservationClearOut, radioValue)\n      ),\n    }).catch((e) => {\n      console.log(e);\n      setSavedSuccessfully(false);\n    });\n    setOpen(true);\n  };\n\n  const handleClose = (event, reason) => {\n    if (reason === 'clickaway') return;\n    setOpen(false);\n  };\n\n  return (\n    <BaseContainer>\n      <AdminForm>\n        <form>\n          <StyledTextField\n            InputLabelProps={{\n              shrink: true,\n            }}\n            fullWidth\n            type=\"text\"\n            placeholder=\"e.g. Headstorm\"\n            name=\"companyName\"\n            value={formData.companyName}\n            onChange={(e) => handleTextFieldChange(e)}\n            label=\"Company Name\"\n          />\n          <StyledTextField\n            InputLabelProps={{\n              shrink: true,\n            }}\n            type=\"number\"\n            name=\"occupancyRule\"\n            placeholder=\"e.g. 25\"\n            onChange={(e) => handleTextFieldChange(e)}\n            value={formData.occupancyRule}\n            fullWidth\n            label=\"Occupancy Rule\"\n          />\n          <StyledTextField\n            InputLabelProps={{\n              shrink: true,\n            }}\n            type=\"text\"\n            name=\"currentRules\"\n            placeholder=\"e.g. Rule 1, Rule 2, ...\"\n            onChange={(e) => handleTextFieldChange(e)}\n            value={formData.currentRules}\n            fullWidth\n            label=\"Current Rules\"\n          />\n          <StyledTextField\n            InputLabelProps={{\n              shrink: true,\n            }}\n            type=\"text\"\n            fullWidth\n            placeholder=\"e.g. Have a good day!\"\n            onChange={(e) => handleTextFieldChange(e)}\n            name=\"successMessage\"\n            value={formData.successMessage}\n            label=\"Success Message\"\n          />\n          <StyledNumberField\n            type=\"number\"\n            name=\"reservationClearOut\"\n            label=\"Reservation Reset\"\n            onChange={(e) => handleTextFieldChange(e)}\n            onBlur={(e) => handleTimeBlur(e)}\n            error={isTimeError}\n            helperText={isTimeError ? 'must be 1-12' : ''}\n            value={formData.reservationClearOut}\n            InputProps={{ inputProps: { min: 0, max: 12 } }}\n            InputLabelProps={{\n              shrink: true,\n            }}\n          />\n          <StyledRadioGroup\n            name=\"amPm\"\n            row\n            value={radioValue}\n            onChange={(e) => handleRadioChange(e)}\n          >\n            <FormControlLabel value=\"am\" control={<StyledRadio />} label=\"AM\" />\n            <FormControlLabel value=\"pm\" control={<StyledRadio />} label=\"PM\" />\n          </StyledRadioGroup>\n        </form>\n      </AdminForm>\n      <MiddleDiv>\n        <Line data={lineChartInfo} options={lineChartOptions} />\n      </MiddleDiv>\n      <FooterDiv>\n        <StyledSnackBar\n          autoHideDuration={3000}\n          anchorOrigin={{ vertical: 'bottom', horizontal: 'left' }}\n          open={open}\n          onClose={handleClose}\n        >\n          {savedSuccessfully ? (\n            <MuiAlert severity=\"success\">Saved</MuiAlert>\n          ) : (\n            <MuiAlert severity=\"error\">Error saving</MuiAlert>\n          )}\n        </StyledSnackBar>\n        <StyledButton\n          size=\"large\"\n          variant=\"contained\"\n          onClick={() => handleClick()}\n        >\n          Save\n        </StyledButton>\n      </FooterDiv>\n    </BaseContainer>\n  );\n};\n\nexport default withRouter(Admin);\n"],"sourceRoot":""}